<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Recruiter Metrics â€¢ Vintti Hub</title>
  <script src="./assets/js/auth-guard.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fuente Onest -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Onest:wght@400;600;700;800&display=swap"
    rel="stylesheet"
  />

  <link rel="stylesheet" href="./assets/css/recruiter-power.css" />
  <style>
    .metric-card[data-metric-detail] {
      cursor: pointer;
      transition: box-shadow 0.25s ease, transform 0.25s ease;
    }
    .metric-card--detail-disabled,
    .metric-card--detail-disabled:hover {
      cursor: not-allowed;
      opacity: 0.6;
      transform: none;
      box-shadow: none;
    }
    .metric-detail-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .metric-detail-modal.is-visible {
      display: flex;
    }
    .metric-detail-modal__overlay {
      position: absolute;
      inset: 0;
      background: rgba(20, 7, 33, 0.6);
      backdrop-filter: blur(4px);
    }
    .metric-detail-modal__panel {
      position: relative;
      max-width: 720px;
      width: min(720px, 92vw);
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 40px 120px rgba(12, 5, 28, 0.35);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      max-height: 85vh;
    }
    .metric-detail-modal__header {
      padding: 1.75rem 2.5rem 0;
    }
    .metric-detail-modal__body {
      padding: 1.5rem 2.5rem 2.25rem;
      overflow-y: auto;
    }
    .metric-detail-modal__close {
      position: absolute;
      top: 1.2rem;
      right: 1.2rem;
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      background: rgba(0, 0, 0, 0.04);
      font-size: 1.4rem;
      cursor: pointer;
    }
    .metric-detail-modal__summary {
      margin: 0 0 1rem 1rem;
      color: #66557c;
    }
    .metric-detail-modal__list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .metric-detail-modal__item {
      border: 1px solid rgba(138, 110, 214, 0.25);
      border-radius: 16px;
      padding: 1rem 1.25rem;
      background: rgba(248, 244, 255, 0.95);
    }
    .metric-detail-modal__item--positive {
      border-color: rgba(108, 175, 146, 0.35);
      background: #ecf9f3;
    }
    .metric-detail-modal__item--negative {
      border-color: rgba(217, 125, 143, 0.35);
      background: #fff0f3;
    }
    .metric-detail-modal__item-secondary {
      color: #6f5a98;
    }
    .metric-detail-modal__item-meta {
      font-size: 0.85rem;
      margin-top: 0.35rem;
      color: #8b7ca8;
    }
    .metric-detail-modal__badge {
      display: inline-flex;
      margin-top: 0.45rem;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.15rem 0.9rem;
      border-radius: 999px;
      background: rgba(107, 97, 139, 0.12);
      color: #5f4d7a;
    }
    .metric-detail-modal__item--positive .metric-detail-modal__badge {
      background: rgba(64, 150, 116, 0.18);
      color: #215941;
    }
    .metric-detail-modal__item--negative .metric-detail-modal__badge {
      background: rgba(210, 95, 121, 0.18);
      color: #7b1c36;
    }
    .metric-detail-modal__empty {
      margin: 0;
      color: #6d5c86;
    }
  </style>
</head>
<a
  id="recruiterLabBtn"
  class="recruiter-lab-btn"
  href="https://dashboard.vintti.com/public/dashboard/ca9c80d2-854e-4feb-9a99-5cc6e2519c84?mode=monthly_cr_cw=&recruiter=&recruiter1=&tab=41-wins-%26-losts"
  target="_blank"
  rel="noopener"
  style="display:none"
>
  <span class="lab-emoji">ðŸ§ª</span>
  <span class="lab-text">Recruiter Lab</span>
</a>
<body>
  <main class="metrics-page">
<header class="metrics-header">
  <div class="metrics-title-block">
    <h1 class="metrics-title">Recruiter Performance Dashboard</h1>
    <p class="metrics-subtitle">
      Track wins, losses and conversion rate per HR lead (custom date range + lifetime).
    </p>
  </div>
</header>

<!-- âœ… filtros debajo del tÃ­tulo -->
<section class="metrics-filters" aria-label="Filters">
  <div class="metrics-filter">
    <label for="hrLeadSelect" class="filter-label">Recruiter</label>
    <select id="hrLeadSelect" class="filter-select">
      <option value="">Loading recruiters...</option>
    </select>
  </div>

  <div class="metrics-filter">
    <span class="filter-label">Date range</span>

    <div class="date-range">
      <label class="date-chip">
        <span class="date-chip-label">From</span>
        <input id="rangeStart" type="date" />
      </label>

      <label class="date-chip">
        <span class="date-chip-label">To</span>
        <input id="rangeEnd" type="date" />
      </label>

      <button id="applyRangeBtn" class="apply-range-btn" type="button">
        Apply
      </button>
    </div>

    <div id="rangeError" class="range-error" style="display:none;"></div>
  </div>
</section>
    <div class="metrics-tabs" role="tablist" aria-label="Dashboard views">
      <button type="button" class="metrics-tab is-active" data-tab-target="summary">
        Summary
      </button>
      <button type="button" class="metrics-tab" data-tab-target="history">
        Historic trends
      </button>
    </div>

    <section class="metrics-tabpanel is-active" data-tab-panel="summary" id="summaryTab">
      <section class="metrics-cards" aria-live="polite">
      <article
        class="metric-card metric-win-month metric-card--detail-disabled"
        data-metric-detail="closedWinRange"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label" id="winRangeLabel">Closed Win Â· Last 30 Days</span>
          <span class="metric-compare" id="winMonthCompare">â€“</span>
        </div>
        <div class="metric-value" id="closedWinMonthValue">â€“</div>
        <p class="metric-caption">
          Opportunities marked as <strong>Closed Win</strong> in the last 30 days.
        </p>
      </article>

      <article
        class="metric-card metric-lost-month metric-card--detail-disabled"
        data-metric-detail="closedLostRange"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
         <span class="metric-label" id="lostRangeLabel">Closed Lost Â· Last 30 Days</span>
          <span class="metric-compare" id="lostMonthCompare">â€“</span>
        </div>
        <div class="metric-value" id="closedLostMonthValue">â€“</div>
        <p class="metric-caption">
          Opportunities marked as <strong>Closed Lost</strong> in the last 30 days.
        </p>
      </article>

      <article
        class="metric-card metric-win-total metric-card--detail-disabled"
        data-metric-detail="closedWinTotal"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Total Closed Win</span>
          <span class="metric-pill metric-pill-win-soft">All time</span>
        </div>
        <div class="metric-value" id="closedWinTotalValue">â€“</div>
        <p class="metric-caption">
          Lifetime <strong>Closed Win</strong> opportunities for this recruiter.
        </p>
      </article>

      <article
        class="metric-card metric-lost-total metric-card--detail-disabled"
        data-metric-detail="closedLostTotal"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Total Closed Lost</span>
          <span class="metric-pill metric-pill-lost-soft">All time</span>
        </div>
        <div class="metric-value" id="closedLostTotalValue">â€“</div>
        <p class="metric-caption">
          Lifetime <strong>Closed Lost</strong> opportunities for this recruiter.
        </p>
      </article>

      <article
        class="metric-card metric-conversion metric-card--detail-disabled"
        data-metric-detail="conversionRange"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label" id="convRangeLabel">Conversion Â· Last 30 Days</span>
          <span class="metric-pill metric-pill-conv">%</span>
        </div>
        <div class="metric-value" id="conversionRateValue">â€“</div>
        <p class="metric-caption" id="conversionHelper">
          Percentage of <strong>Closed Win</strong> among closed opportunities in the last 30 days.
        </p>
      </article>

      <article
        class="metric-card metric-conversion-lifetime metric-card--detail-disabled"
        data-metric-detail="conversionLifetime"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Conversion Â· Lifetime</span>
          <span class="metric-pill metric-pill-conv">%</span>
        </div>
        <div class="metric-value" id="conversionLifetimeValue">â€“</div>
        <p class="metric-caption">
          Lifetime share of <strong>Closed Win</strong> over all closed opportunities.
        </p>
      </article>

      <article
        class="metric-card metric-close-win-avg metric-card--detail-disabled"
        data-metric-detail="avgCloseWin"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Average days to close (Win)</span>
          <span class="metric-pill metric-pill-win-soft">Selected range</span>
        </div>
        <div class="metric-value" id="avgCloseWinValue">â€“</div>
        <p class="metric-caption">
          From start date (NDA/sourcing) to <strong>Closed Win</strong> within the selected range.
        </p>
      </article>

      <article
        class="metric-card metric-close-lost-avg metric-card--detail-disabled"
        data-metric-detail="avgCloseLost"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Average days to close (Lost)</span>
          <span class="metric-pill metric-pill-lost-soft">Selected range</span>
        </div>
        <div class="metric-value" id="avgCloseLostValue">â€“</div>
        <p class="metric-caption">
          From start date to <strong>Closed Lost</strong> within the selected range.
        </p>
      </article>

      <article
        class="metric-card metric-batch-open metric-card--detail-disabled"
        data-metric-detail="avgBatchOpen"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Average days to first batch (Open)</span>
          <span class="metric-pill metric-pill-conv">Active opps</span>
        </div>
        <div class="metric-value" id="avgBatchOpenValue">â€“</div>
        <p class="metric-caption">
          Open opportunities starting within the range. 
        </p>
      </article>

      <article
        class="metric-card metric-batch-closed metric-card--detail-disabled"
        data-metric-detail="avgBatchClosed"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Average days to first batch (Closed)</span>
          <span class="metric-pill metric-pill-conv">Closed opps</span>
        </div>
        <div class="metric-value" id="avgBatchClosedValue">â€“</div>
        <p class="metric-caption">
          Closed opportunities where the first batch landed before closing.
        </p>
      </article>

      <article
        class="metric-card metric-interview-rate metric-card--detail-disabled"
        data-metric-detail="interviewRate"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Interview rate</span>
          <span class="metric-pill metric-pill-conv">Interviewed / Sent</span>
        </div>
        <div class="metric-value" id="interviewRateValue">â€“</div>
        <p class="metric-caption">
          Share of sent candidates that reached interview stages.
        </p>
        <p class="metric-caption metric-caption-subtle" id="interviewRateHelper">(â€” / â€”)</p>
      </article>

      <article
        class="metric-card metric-hire-rate metric-card--detail-disabled"
        data-metric-detail="hireRate"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Hire rate</span>
          <span class="metric-pill metric-pill-conv">Hired / Sent</span>
        </div>
        <div class="metric-value" id="hireRateValue">â€“</div>
        <p class="metric-caption">
          Sent candidates that converted into hires in the selected range.
        </p>
        <p class="metric-caption metric-caption-subtle" id="hireRateHelper">(â€” / â€”)</p>
      </article>

      <article
        class="metric-card metric-sent-vs-interview metric-card--detail-disabled"
        data-metric-detail="sentVsInterview"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Sent vs Interviewed</span>
          <span class="metric-pill metric-pill-conv">Sent / Interviewed</span>
        </div>
        <div class="metric-value" id="sentVsInterviewValue">â€“</div>
        <p class="metric-caption">
          Average candidate batches sent versus candidates recruiters interviewed.
        </p>
        <p class="metric-caption metric-caption-subtle" id="sentVsInterviewHelper">
          No opportunities with recruiter interview counts yet.
        </p>
      </article>

      <article
        class="metric-card metric-churn-range metric-card--detail-disabled"
        data-metric-detail="churnRange"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Total churn Â· Lifetime</span>
          <span class="metric-pill metric-pill-churn">Lifetime view</span>
        </div>
        <div class="metric-value" id="churnRangeCount">â€“</div>
        <p class="metric-caption" id="churnRangeHelper">
          Lifetime churn will appear once hires are recorded.
        </p>
      </article>

      <article
        class="metric-card metric-early-churn metric-card--detail-disabled"
        data-metric-detail="churn90Days"
        role="button"
        tabindex="-1"
        aria-disabled="true"
      >
        <div class="metric-header">
          <span class="metric-label">Total churn - 90 days</span>
          <span class="metric-pill metric-pill-early">Tenure insight</span>
        </div>
        <div class="metric-value metric-value-combo" id="left90Value">
          <span class="metric-number" id="left90Count">â€“</span>
          <span class="metric-percent" id="left90Rate">â€“</span>
        </div>
        <p class="metric-caption metric-caption-subtle" id="left90RangeLabel"></p>
      </article>
      </section>

      <section class="meta-footer">
        <p id="periodInfo" class="meta-text"></p>
      </section>
    </section>

    <section class="metrics-tabpanel" data-tab-panel="history" id="historyTab">
      <section class="history-panel" id="historyPanel" aria-live="polite">
        <header class="history-header">
          <div>
            <h2 class="history-title">Historic recruiting performance</h2>
            <p class="history-subtitle" id="historySubtitle">
              Pick a recruiter to explore their timeline.
            </p>
          </div>
          <div class="history-meta">
            <span class="history-meta__label">Global filters</span>
            <span class="history-meta__value" id="historyGlobalFilters">â€”</span>
          </div>
        </header>

        <div class="history-filters" aria-label="Historic filters">
          <div class="history-filter-group">
            <label for="historyRangeStart" class="history-filter-label">From</label>
            <input id="historyRangeStart" type="month" />
          </div>
          <div class="history-filter-group">
            <label for="historyRangeEnd" class="history-filter-label">To</label>
            <input id="historyRangeEnd" type="month" />
          </div>
          <div class="history-quick-actions" id="historyQuickActions"></div>
        </div>

        <div class="history-error" id="historyError" hidden></div>
        <div class="history-spotlights" id="historyHighlights"></div>
        <div class="history-loading" id="historyLoading" hidden>Plotting metricsâ€¦</div>
        <div class="history-empty" id="historyEmpty">
          Select a recruiter above to render the dashboard.
        </div>
        <div class="history-grid" id="historyGrid"></div>
        <div class="history-table-card" id="historyTableContainer" hidden>
          <div class="history-card__header">
            <div>
              <span class="history-card__label">Recent months</span>
              <p class="history-card__description">Last six data points for quick reference.</p>
            </div>
          </div>
          <div class="history-table-wrapper">
            <table class="history-table" aria-label="Recent monthly breakdown">
              <thead>
                <tr id="historyTableHead"></tr>
              </thead>
              <tbody id="historyTableBody"></tbody>
            </table>
          </div>
        </div>
      </section>
    </section>
  </main>

  <div id="historyChartModal" class="history-chart-modal" hidden>
    <div class="history-chart-modal__overlay" data-chart-modal-close></div>
    <div
      class="history-chart-modal__panel"
      role="dialog"
      aria-modal="true"
      aria-labelledby="historyChartModalTitle"
    >
      <button
        type="button"
        class="history-chart-modal__close"
        aria-label="Close enlarged chart"
        data-chart-modal-close
      >
        Ã—
      </button>
      <div class="history-chart-modal__body">
        <div class="history-chart-modal__header">
          <h3 id="historyChartModalTitle">Metric detail</h3>
          <p id="historyChartModalDescription"></p>
        </div>
        <div id="historyChartModalContent" class="history-chart-modal__content"></div>
      </div>
    </div>
  </div>

  <div id="metricDetailModal" class="metric-detail-modal" hidden>
    <div class="metric-detail-modal__overlay" data-modal-overlay></div>
    <div
      class="metric-detail-modal__panel"
      role="dialog"
      aria-modal="true"
      aria-labelledby="metricDetailTitle"
    >
      <button type="button" id="metricDetailCloseBtn" class="metric-detail-modal__close" aria-label="Close details">
        Ã—
      </button>
      <div class="metric-detail-modal__header">
        <h2 id="metricDetailTitle">Metric detail</h2>
        <p id="metricDetailContext"></p>
      </div>
      <div class="metric-detail-modal__body">
        <ul id="metricDetailSummary" class="metric-detail-modal__summary"></ul>
        <ul id="metricDetailList" class="metric-detail-modal__list"></ul>
        <p id="metricDetailEmpty" class="metric-detail-modal__empty"></p>
      </div>
    </div>
  </div>

  <script src="./assets/js/recruiter-power.js"></script>
</body>
</html>
