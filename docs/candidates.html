<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ====== Meta ====== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Candidates</title>
  <meta name="theme-color" content="#0B3D91" />

  <!-- (Optional) Helpful description for SEO / share cards -->
  <meta name="description" content="Vintti Hub · Candidates table with quick filters and search." />

  <!-- ====== Icons / PWA bits (kept as-is) ====== -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="apple-touch-icon" href="/icons/vintti-hub-180.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#0B3D91">

  <!-- ====== Fonts ====== -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Onest:wght@400;600&display=swap" rel="stylesheet">

  <!-- ====== Vendor CSS ====== -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- ====== App CSS (kept path and filename) ====== -->
  <link rel="stylesheet" href="./assets/css/candidates.css" />
  <style>
    .candidates-loading-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(205, 255, 48, 0.3), rgba(253, 244, 238, 0.95));
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30000;
      transition: opacity 0.25s ease;
    }
    .candidates-loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    .candidates-loading-card {
      width: min(320px, 90vw);
      padding: 32px 28px;
      border-radius: 24px;
      background: #fff;
      box-shadow: 0 20px 50px rgba(15, 23, 42, 0.18);
      text-align: center;
      font-family: 'Onest', sans-serif;
    }
    .candidates-loading-spinner {
      width: 48px;
      height: 48px;
      margin: 0 auto 18px;
      border-radius: 50%;
      border: 4px solid rgba(0, 68, 255, 0.12);
      border-top-color: #0044ff;
      animation: candidatesLoadingSpin 0.9s linear infinite;
    }
    .candidates-loading-title {
      margin: 0;
      font-size: 1.15rem;
      font-weight: 600;
      color: #0b3d91;
    }
    .candidates-loading-text {
      margin: 6px 0 0;
      font-size: 0.95rem;
      color: #1f2937;
    }
    @keyframes candidatesLoadingSpin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>

<body class="light-mode">
  <div
    id="candidatesLoadingOverlay"
    class="candidates-loading-overlay hidden"
    aria-live="polite"
    aria-label="Loading candidates"
    aria-hidden="true"
  >
    <div class="candidates-loading-card">
      <div class="candidates-loading-spinner" aria-hidden="true"></div>
      <p class="candidates-loading-title">Loading candidates</p>
      <p class="candidates-loading-text">Fetching the latest information…</p>
    </div>
  </div>
    <!-- =========================================================
       Sidebar
    ========================================================== -->
<aside class="sidebar">
  <img src="./assets/img/vintti_logo.png" alt="Vintti Logo" class="logo" />

  <nav class="sidebar-nav">
    <!-- Sección 1: Core -->
    <p class="sidebar-section-label">CORE</p>

    <a class="menu-item active" href="candidates.html">
      <span class="menu-icon"><i class="fa-solid fa-user-group"></i></span>
      <span class="menu-label">Candidates</span>
    </a>

    <a class="menu-item" href="crm.html">
      <span class="menu-icon"><i class="fa-solid fa-building"></i></span>
      <span class="menu-label">CRM</span>
    </a>

    <a class="menu-item" href="opportunities.html">
      <span class="menu-icon"><i class="fa-solid fa-chart-line"></i></span>
      <span class="menu-label">Opportunities</span>
    </a>

    <a class="menu-item" id="candidateSearchLink" href="candidate-search.html" style="display:none;">
      <span class="menu-icon"><i class="fa-solid fa-magnifying-glass"></i></span>
      <span class="menu-label">Candidate Search</span>
    </a>

    <a class="menu-item" href="equipments.html" id="equipmentsLink">
      <span class="menu-icon"><i class="fa-solid fa-laptop"></i></span>
      <span class="menu-label">Equipments</span>
    </a>

    <!-- Sección 2: Insights -->
    <p class="sidebar-section-label">INSIGHTS</p>

    <a class="menu-item" id="summaryLink" href="opportunities-summary.html" style="display:none;">
      <span class="menu-icon"><i class="fa-solid fa-chart-column"></i></span>
      <span class="menu-label">Opportunities Summary</span>
    </a>

    <a
      class="menu-item"
      id="dashboardLink"
      href="https://dashboard.vintti.com/public/dashboard/a6d74a9c-7ffb-4bec-b202-b26cdb57ff84?meses=3&metric_arpa=&metrica=revenue&tab=5-growth-%26-revenue"
      target="_blank"
      rel="noopener"
    >
      <span class="menu-icon"><i class="fa-solid fa-gauge-high"></i></span>
      <span class="menu-label">Dashboard</span>
    </a>

    <a class="menu-item" href="control-dashboard.html" id="managementMetricsLink">
      <span class="menu-icon"><i class="fa-solid fa-chart-bar"></i></span>
      <span class="menu-label">Management Metrics</span>
    </a>

    <a class="menu-item" id="recruiterPowerLink" href="recruiter-power.html" style="display:none;">
      <span class="menu-icon"><i class="fa-solid fa-bolt"></i></span>
      <span class="menu-label">Recruiter Power</span>
    </a>
    <a
      class="menu-item"
      id="salesLink"
      href="https://dashboard.vintti.com/public/dashboard/8e7a1373-cfc1-4549-81da-24566d81c9d3?month_ndacw=&month_ndas="
      target="_blank"
      rel="noopener"
    >
      <span class="menu-icon"><i class="fa-solid fa-rocket"></i></span>
      <span class="menu-label">Sales Force</span>
    </a>
  </nav>

  <!-- Profile tile SIEMPRE pegado abajo -->
  <a href="profile.html" class="profile-tile" id="sidebarProfile">
    <span class="profile-avatar">
      <img id="profileAvatarImg" alt="" />
      <span id="profileAvatarInitials" class="profile-initials" aria-hidden="true">—</span>
    </span>
    <span class="profile-meta">
      <span id="profileName" class="profile-name">-</span>
      <span id="profileEmail" class="profile-email"></span>
    </span>
  </a>
</aside>

  <!-- Sidebar toggle (kept IDs/classes) -->
  <div class="sidebar-wow-toggle" id="sidebarToggle" role="button" aria-label="Toggle sidebar" tabindex="0">
    <i class="fa-solid fa-chevron-left" id="sidebarToggleIcon" aria-hidden="true"></i>
  </div>

  <!-- ======================== Main ======================== -->
  <main class="main-content">
    <header class="page-header">
      <h1 class="page-title">Candidates</h1>
      <button class="new-btn" type="button" id="openCandidateModalBtn">New</button>
    </header>

    <!-- Controls: left (DataTables UI) + right (name search) -->
    <div class="table-controls-wrapper" role="region" aria-label="Table controls">
      <div class="left-controls">
        <!-- DataTables will inject its controls here -->
        <div id="datatable-wrapper"></div>
          </div>
              <!-- === Filtros avanzados (Status / Modelo) === -->
          <div class="filters-bar">
            <label class="sr-only" for="statusFilter">Status</label>
            <select id="statusFilter" class="filter-select">
              <option value="">Status: All</option>
              <option value="active">Active</option>
              <option value="unhired">Unhired</option>
            </select>

            <label class="sr-only" for="modelFilter">Model</label>
            <select id="modelFilter" class="filter-select">
              <option value="">Model: All</option>
              <option value="Recruiting">Recruiting</option>
              <option value="Staffing">Staffing</option>
            </select>

            <label class="sr-only" for="blacklistFilter">Blacklist</label>
            <select id="blacklistFilter" class="filter-select">
              <option value="all">Blacklist: All</option>
              <option value="only">Only blacklisted</option>
              <option value="exclude">Exclude blacklisted</option>
            </select>
          </div>
      <div class="right-controls">
        <!-- Kept id/class; added label for a11y -->
        <label for="searchByName" class="sr-only">Search by name</label>
        <input type="text" id="searchByName" placeholder="Search by name..." class="name-search-input" />
      </div>
    </div>

    <!-- ======================== Candidates Table ======================== -->
    <div class="table-container" role="region" aria-label="Candidates table">
      <!-- Kept table id/thead structure for your JS -->
      <table id="candidatesTable">
        <thead>
          <tr>
            <th>
              <span class="column-filter" data-column="0" title="Filter Condition">
                <i class="fa-solid fa-filter" aria-hidden="true"></i>
              </span>
              <span>Condition</span>
            </th>
            <th>
              <span class="column-filter" data-column="1" title="Filter Full Name">
                <i class="fa-solid fa-filter" aria-hidden="true"></i>
              </span>
              <span>Full Name</span>
            </th>
            <th>Country</th>
            <th>Whatsapp</th>
            <th>LinkedIn</th>
            <th>Blacklist</th>
          </tr>
        </thead>
        <tbody id="candidatesTableBody"></tbody>
      </table>
    </div>
    <!-- ====================== /Candidates Table ====================== -->
  </main>
  <button id="logoutFab" class="logout-fab" title="Log out">
    <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
    <span>Log out</span>
  </button>

  <div id="candidateCreateModal" class="candidate-modal-overlay" hidden aria-hidden="true">
    <div class="candidate-modal" role="dialog" aria-modal="true" aria-labelledby="candidateModalTitle">
      <button class="modal-close-btn" id="candidateModalCloseBtn" type="button" aria-label="Close">
        &times;
      </button>
      <h2 id="candidateModalTitle">Add Candidate</h2>
      <p class="modal-description">Create a new candidate and make them available to every pipeline.</p>

      <div id="candidateFormError" class="candidate-form-error" hidden></div>

      <div id="candidateDuplicateBox" class="candidate-duplicate-box" hidden>
        <strong>A candidate with this information already exists.</strong>
        <div id="candidateDuplicateFields" class="duplicate-fields"></div>
        <button type="button" class="duplicate-link" id="openExistingCandidateBtn">Open existing candidate</button>
      </div>

      <form id="candidateCreateForm" class="candidate-form">
        <label class="candidate-field">
          <span>Full name</span>
          <input type="text" id="candidateFullName" name="full_name" placeholder="Full name" autocomplete="name" />
        </label>

        <label class="candidate-field required">
          <span>Email <span class="required-marker">*</span></span>
          <input type="email" id="candidateEmail" name="email" placeholder="Email *" autocomplete="email" required />
        </label>

        <label class="candidate-field">
          <span>Country</span>
          <div class="searchable-select" data-target="candidateCountry">
            <button type="button" class="searchable-select__display" id="candidateCountryDisplay">
              Select country…
            </button>
            <div class="searchable-select__dropdown" id="candidateCountryDropdown" hidden>
              <input
                type="text"
                class="searchable-select__search"
                id="candidateCountrySearch"
                placeholder="Search country…"
                aria-label="Search country"
              />
              <div class="searchable-select__options" id="candidateCountryOptions" role="listbox"></div>
            </div>
          </div>
          <select id="candidateCountry" name="country" hidden></select>
        </label>

        <div class="candidate-field">
          <span>Phone <span class="required-marker">*</span></span>
          <div class="phone-split">
            <select id="candidatePhoneCode" name="phone_code"></select>
            <input type="tel" id="candidatePhone" name="phone" placeholder="Phone number *" autocomplete="tel" required />
          </div>
        </div>

        <label class="candidate-field required">
          <span>LinkedIn URL <span class="required-marker">*</span></span>
          <input type="url" id="candidateLinkedin" name="linkedin" placeholder="https://linkedin.com/in/username *" autocomplete="url" required />
        </label>

        <button type="submit" id="candidateModalSubmit" class="create-btn">Create Candidate</button>
      </form>
    </div>
  </div>
  <div id="candidateCreateToast" class="candidate-toast" role="status" aria-live="polite" hidden></div>
  <!-- ======================== Scripts (order preserved; deferred) ======================== -->
  <!-- jQuery first (required by DataTables) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" defer></script>
  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js" defer></script>
  <!-- Font Awesome JS (icons) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" defer></script>
  <!-- JS específico de Candidates -->
  <script src="./assets/js/candidate.js" defer></script>

  <!-- SFX (kept id/src). Preload left as-is; controls hidden for UX -->
  <audio id="click-sound" src="./assets/sounds/transition_tables.mp3" preload="auto"></audio>
</body>
</html>
