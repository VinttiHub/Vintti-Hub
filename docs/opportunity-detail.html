<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Opportunity Details</title>
  <link rel="stylesheet" href="./assets/css/opportunity-detail.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

</head>
<script src="./assets/js/pipeline.js"></script>
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script type="module" src="https://unpkg.com/emoji-picker-element?module"></script>

<body>
  <div id="fixedBackContainer">
    <button id="goBackButton" class="go-back-button">â† Go Back</button>
  </div>
  <header class="detail-header">
    <div class="header-left">
      <h1 class="detail-title">Opportunity Detail</h1>
    </div>
      <nav class="detail-nav">
        <ul>
          <li class="nav-item active">Overview</li>
          <li class="nav-item">Information</li>
          <li class="nav-item">Job Description</li>
          <li class="nav-item">Pipeline</li>
          <li class="nav-item">Candidates</li>
          <div class="nav-indicator"></div>
        </ul>
      </nav>
  </header>

  <main class="detail-main">
    <section id="overview" class="detail-section">
      <div class="section-header">
        <h2 class="overview-title">Overview</h2>
        <p class="section-subtext"> </p>
      </div>

<div class="overview-card pastel-card" style="padding-top: 2rem;">
  <div class="stage-top">
    <div class="opportunity-id-card">
      <span class="label">Opportunity ID</span>
      <span id="opportunity-id-text" data-id="">1</span>
    </div>
    <div class="opportunity-stage-card" id="stage-tag">
      <span id="stage-text">â€”</span>
    </div>
  </div>
  <div class="overview-grid">
    <div class="input-group">
      <label>Start Date</label>
      <input type="text" id="start-date-input" value="" />
    </div>
    <div class="input-group">
      <label>Signed</label>
      <div class="info-tag" id="signed-tag">â€”</div>
    </div>
    <div class="input-group">
      <label>Closed Date</label>
      <input type="text" id="close-date-input" placeholder="Closed Date" />
    </div>
    <div class="input-group">
      <label>Hire</label>
      <input id="hire-display" type="text" readonly placeholder="No hire assigned yet" />
    </div>
  </div>
  <div class="input-group comments-group">
  <label>Comments</label>
  <textarea id="comments-overview-textarea" placeholder="Write internal comments here..."></textarea>
</div>
</div>

<!-- Client -->
<div class="overview-card">
  <div class="card-title-row">
    <button class="card-toggle">
      <h3>Client</h3>
      <span class="toggle-icon">â–¾</span>
    </button>
  </div>
  <div class="card-content">
    <div class="overview-grid">
      <div class="input-group"><label>Name</label><input id="client-name-input" value="" readonly/></div>
      <div class="input-group">
        <label>Size</label>
        <input type="text" id="client-size-input" value="" readonly />
      </div>
      <div class="input-group"><label>State</label><input id="client-state-input" value="" ></div>
      <div class="input-group"><label>Linkedin</label><input id="client-linkedin-input" value="" ></div>
      <div class="input-group"><label>Website</label><input id="client-website-input" value="" ></div>
      <div class="input-group full"><label>Mail</label><input id="client-mail-input" value="" ></div>
      <div class="input-group full"><label>About</label><textarea id="client-about-textarea" placeholder="Client background, culture, values..." class="taller-textarea"></textarea></div>
    </div>
  </div>
</div>


<!-- Details -->
<div class="overview-card">
  <button class="card-toggle">
    <h3>Details</h3>
    <span class="toggle-icon">â–¾</span>
  </button>
  <div class="card-content">
    <div class="overview-grid">
      <div class="input-group"><label>Opportunity Name</label><input id="details-opportunity-name" value="" ></div>
      <div class="input-group"><label>Account</label><input id="details-account-name" value="" readonly/></div>
      <div class="input-group"><label>Sales Lead</label><select id="details-sales-lead"><option></option></select></div>
      <div class="input-group"><label>HR Lead</label><select id="details-hr-lead"><option></option></select></div>
      <div class="input-group"><label>Model</label>
        <select id="details-model">
          <option value="Staffing">Staffing</option>
          <option value="Recruiting">Recruiting</option>
        </select>
      </div>
    </div>
  </div>
</div>

    </section>
          <section id="information" class="detail-section hidden">
        <div class="section-header">
          <p class="section-subtext"></p>
        </div>
        <div class="overview-card">
          <div class="overview-grid">
            <div class="input-group"><label>Client Budget</label><input id="min-budget-input" /></div>
            <div class="input-group"><label>&nbsp;</label><input id="max-budget-input" /></div>
            <div class="input-group"><label>Candidate Salary Range</label><input id="min-salary-input" /></div>
            <div class="input-group"><label>&nbsp;</label><input id="max-salary-input" /></div>
            <div class="input-group"><label>Model</label>
              <select id="model-select">
                <option value="Staffing">Staffing</option>
                <option value="Recruiting">Recruiting</option>
              </select>
            </div>
            <div class="input-group"><label>Years of Experience</label><input id="years-experience-input" /></div>
            <div class="input-group"><label>Set Up Fee</label><input id="fee-input" /></div>
            <div class="input-group"><label>Time Zone</label><input id="timezone-input" /></div>
            <div class="input-group full"><label>First Meeting Recording</label><input id="recording-input" /></div>
            <div class="input-group full">
              <label>Deep Dive Recording</label>
              <input id="deepdive-recording-input" placeholder="Deep dive recording..." />
            </div>
            <div class="input-group full"><label>First Meeting Comments</label><textarea id="comments-firstmeeting-textarea" placeholder="Summary of the first meeting..." class="taller-textarea"></textarea></div>
            <div class="input-group full">
              <label>Client Interviewing Process</label>
              <div class="toolbar small-toolbar" id="interviewing-toolbar">
                <button data-command="bold" onclick="toggleActiveButton('bold', this)"><b>B</b></button>
                <button data-command="italic" onclick="toggleActiveButton('italic', this)"><i>I</i></button>
                <button onclick="document.execCommand('insertUnorderedList', false, '')">â€¢ List</button>
              </div>
              <div id="interviewing-process-editor" contenteditable="true" class="job-description-editor" placeholder="Describe the client interview steps..."></div>
            </div>

          </div>
        </div>
      </section>

    <section id="job" class="detail-section hidden">
      <div class="job-header">
        <div class="job-header-left">
          <h2>Job Description</h2>
          <p class="subtitle">Complete job description for this opportunity.</p>
        </div>
        <div class="job-header-right">
          <button class="header-btn">Send</button>
        </div>
      </div>
      <div class="toolbar" id="job-toolbar">
        <button data-command="bold" onclick="toggleActiveButton('bold', this)"><b>B</b></button>
        <button data-command="italic" onclick="toggleActiveButton('italic', this)"><i>I</i></button>
        <button onclick="document.execCommand('insertUnorderedList', false, '')">â€¢ List</button>
        <div style="position: relative; display: inline-block;">
          <button id="emoji-trigger">ğŸ˜Š</button>
          <emoji-picker id="emoji-picker" style="position: absolute; top: 100%; left: 0; display: none;"></emoji-picker>
        </div>
      </div>
      <div class="job-card">
        <div id="job-description-textarea" contenteditable="true" class="job-description-editor" placeholder="Write your message here..."></div>  
      </div>
    </section>
    
    <section id="pipeline" class="detail-section hidden pipeline-section">
      <div class="pipeline-header">
        <h2>Pipeline</h2>
        <div class="pipeline-actions">
          <button id="createCandidateBtn">+ Create Candidate</button>
          <button id="signOffBtn">Sign off</button>
        </div>
      </div>
    
      <div class="pipeline-columns">
        <!-- Column 1 -->
        <div class="column" data-status="contacted">
          <h3 style="background-color: #fef2f2;" class="column-title"><span class="column-name">Contactado</span> <span class="column-count" id="count-contacted">0</span></h3>
          <div class="card-container" id="contacted">
          </div>
        </div>
        <!-- Column: No avanza primera -->
        <div class="column" data-status="no-advance">
          <h3 style="background-color: #effaf0;" class="column-title"><span class="column-name">No avanza primera</span> <span class="column-count" id="count-no-advance">0</span></h3>
          <div class="card-container" id="no-advance">
            <!-- puedes dejarlo vacÃ­o por ahora -->
          </div>
        </div>
        <!-- Column 2 -->
        <div class="column" data-status="first-interview">
          <h3 style="background-color: #edf4ff;" class="column-title"><span class="column-name">Primera entrevista</span> <span class="column-count" id="count-first-interview">0</span></h3>
          <div class="card-container" id="first-interview">
          </div>
        </div>
    
        <!-- Column 3 -->
        <div class="column" data-status="client-process">
          <h3 style="background-color: #fef3fb;" class="column-title"><span class="column-name">En proceso con Cliente</span> <span class="column-count" id="count-client-process">0</span></h3>
          <div class="card-container" id="client-process">
          </div>
        </div>
      </div>
    </section>
    
    
    <section id="candidates" class="detail-section fade-in">
      <div class="candidates-header">
        <div>
          <h2>Candidates</h2>
          <p class="subtitle">See the final candidates for this opportunity.</p>
        </div>
      </div>
    
      <div class="batch-table">
        <table>
          <thead>
            <tr>
              <th>Batch #</th>
              <th>Presentation Date</th>
              <th>Time</th>
              <th></th>
            </tr>
          </thead>
            <tbody id="presentation-batch-table-body">
              <!-- AquÃ­ se insertarÃ¡n dinÃ¡micamente las filas -->
            </tbody>
        </table>
      </div>
    
      <div class="batch-detail" id="batch-detail-container">
        <!-- AquÃ­ se insertarÃ¡n dinÃ¡micamente los batch-box -->
      </div>
      <div class="create-batch-wrap">
        <button class="btn-create">Create new batch</button>
      </div>
    </section>
    
  </main>
  <!-- AI Assistant Button -->
  <div id="ai-assistant-btn" style="display: none;">
    âœ¨ AI Assistant âœ¨
  </div>

  <!-- AI Assistant Popup -->
  <div id="ai-assistant-popup" class="ai-popup hidden">
    <div class="ai-popup-content">
      <span id="ai-assistant-close" class="ai-close-x">Ã—</span>
      <h2>AI Assistant</h2>
      <label>Intro Call</label>
      <textarea placeholder="00:00 Speaker: Text here..."></textarea>

      <label>Deep Dive Call</label>
      <input type="text" placeholder="2nd_Call_Transcript" />

      <label>Notes / Emails</label>
      <textarea placeholder="Your notes here..."></textarea>

      <label>Files</label>
      <div class="file-upload" onclick="document.getElementById('ai-file-input').click()">
        <input type="file" id="ai-file-input" />
        <div class="upload-icon">ğŸ“</div>
      </div>
      <div class="button-group">
        <button id="ai-assistant-go">Let's Go ğŸš€</button>
      </div>
    </div>
  </div>
    <!-- ADD Candidate Popup -->
    <div id="candidatePopup" class="popup hidden">
      <div class="popup-content">
        <span class="close-btn" id="closePopup">&times;</span>
        <h2>Add Candidate</h2>
        <input type="text" id="candidate-name" placeholder="Full name *" autocomplete="off"/>
        <p id="name-warning" style="display: none;">Please select a candidate from the list</p>
        <ul id="pipelineCandidateSearchResults" class="search-results-list"></ul>
        <div id="extra-fields">
        <input type="text" id="candidate-email" placeholder="Email *" />
        <select id="candidate-country" required>
          <option value="">Select country...</option>
          <option value="Argentina">ğŸ‡¦ğŸ‡· Argentina</option>
          <option value="Bolivia">ğŸ‡§ğŸ‡´ Bolivia</option>
          <option value="Brazil">ğŸ‡§ğŸ‡· Brazil</option>
          <option value="Chile">ğŸ‡¨ğŸ‡± Chile</option>
          <option value="Colombia">ğŸ‡¨ğŸ‡´ Colombia</option>
          <option value="Costa Rica">ğŸ‡¨ğŸ‡· Costa Rica</option>
          <option value="Cuba">ğŸ‡¨ğŸ‡º Cuba</option>
          <option value="Ecuador">ğŸ‡ªğŸ‡¨ Ecuador</option>
          <option value="El Salvador">ğŸ‡¸ğŸ‡» El Salvador</option>
          <option value="Guatemala">ğŸ‡¬ğŸ‡¹ Guatemala</option>
          <option value="Honduras">ğŸ‡­ğŸ‡³ Honduras</option>
          <option value="Mexico">ğŸ‡²ğŸ‡½ Mexico</option>
          <option value="Nicaragua">ğŸ‡³ğŸ‡® Nicaragua</option>
          <option value="Panama">ğŸ‡µğŸ‡¦ Panama</option>
          <option value="Paraguay">ğŸ‡µğŸ‡¾ Paraguay</option>
          <option value="Peru">ğŸ‡µğŸ‡ª Peru</option>
          <option value="Puerto Rico">ğŸ‡µğŸ‡· Puerto Rico</option>
          <option value="Dominican Republic">ğŸ‡©ğŸ‡´ Dominican Republic</option>
          <option value="Uruguay">ğŸ‡ºğŸ‡¾ Uruguay</option>
          <option value="Venezuela">ğŸ‡»ğŸ‡ª Venezuela</option>
        </select>
        <div style="display: flex; gap: 8px;">
          <select id="phone-country-code" style="width: 30%;">
            <option value="54" selected>ğŸ‡¦ğŸ‡· +54Â  Â Â Argentina</option>
            <option value="591">ğŸ‡§ğŸ‡´ +591Â Â  Â Bolivia</option>
            <option value="55">ğŸ‡§ğŸ‡· +55Â Â  Â Brasil</option>
            <option value="56">ğŸ‡¨ğŸ‡± +56Â Â  Â Chile</option>
            <option value="57">ğŸ‡¨ğŸ‡´ +57Â Â  Â Colombia</option>
            <option value="506">ğŸ‡¨ğŸ‡· +506Â Â  Â Costa Rica</option>
            <option value="53">ğŸ‡¨ğŸ‡º +53Â  Â Â Cuba</option>
            <option value="593">ğŸ‡ªğŸ‡¨ +593Â Â Â  Ecuador</option>
            <option value="503">ğŸ‡¸ğŸ‡» +503Â  Â Â El Salvador</option>
            <option value="502">ğŸ‡¬ğŸ‡¹ +502Â Â  Â Guatemala</option>
            <option value="504">ğŸ‡­ğŸ‡³ +504Â Â  Â Honduras</option>
            <option value="52">ğŸ‡²ğŸ‡½ +52Â Â Â  MÃ©xico</option>
            <option value="505">ğŸ‡³ğŸ‡® +505Â Â  Â Nicaragua</option>
            <option value="507">ğŸ‡µğŸ‡¦ +507Â Â Â  PanamÃ¡</option>
            <option value="595">ğŸ‡µğŸ‡¾ +595Â Â  Â Paraguay</option>
            <option value="51">ğŸ‡µğŸ‡ª +51Â Â  Â PerÃº</option>
            <option value="1">ğŸ‡µğŸ‡· +1Â  Â Â Puerto Rico</option>
            <option value="1">ğŸ‡©ğŸ‡´ +1Â Â  Â RepÃºblica Dominicana</option>
            <option value="598">ğŸ‡ºğŸ‡¾ +598Â Â  Â Uruguay</option>
            <option value="58">ğŸ‡»ğŸ‡ª +58Â Â  Â Venezuela</option>
          </select>
          <input type="text" id="candidate-phone" placeholder="Phone number *" style="width: 70%;" />
        </div>
        <input type="text" id="candidate-linkedin" placeholder="LinkedIn URL *" />
        <button id="popupcreateCandidateBtn">Create Candidate</button>
        </div>
        <button id="popupAddExistingBtn" style="display:none;">Add Candidate to Pipeline</button>
      </div>
    </div>

<!-- Popup para agregar candidato a batch -->
<div id="batchCandidatePopup" class="popup hidden">
  <div class="popup-content">
    <span class="close-btn" id="closeBatchPopup">&times;</span>
    <h2>Select Candidate</h2>
    <input type="text" id="candidateSearchInput" placeholder="Search by name..." />
    <ul id="candidateSearchResults" class="search-results-list"></ul>
  </div>
</div>
<template id="candidate-card-template">
  <div class="candidate-card">
    <div class="candidate-card-header">
      <div class="candidate-info-inline">
        <strong class="candidate-name">Name</strong>
        <span class="candidate-country">ğŸ‡²ğŸ‡½ Mexico</span>
        <span class="candidate-salary">$3500</span>
      </div>
            <select class="candidate-status-dropdown pipeline-only-hide">
            <option disabled value="">Select status...</option>
            <option value="Client rejected CV">Client rejected CV</option>
            <option value="Client interviewing/testing">Client interviewing/testing</option>
            <option value="Client rejected after interviewing">Client rejected after interviewing</option>
            <option value="Candidate abandoned process">Candidate abandoned process</option>
            <option value="Client hired">Client hired</option>
          </select>
    </div>
    <div class="preview">
      <img class="candidate-img" src="" />
        <div class="info">
          <span class="name candidate-name">Name</span>
          <span class="email candidate-email"></span>
          <span class="salary candidate-salary"></span>
          <span class="country candidate-country"></span> <!-- ğŸ”¹ Agregar este span -->
        </div>
    </div>
  </div>
</template>
<div id="emailPopup" class="popup hidden">
  <div class="popup-content email-popup-content">
    <span class="close-btn" id="closeEmailPopup">&times;</span>
    <h2>Send Job Description</h2>

    <label>To</label>
    <select id="email-to" multiple></select>

    <label>CC</label>
    <select id="email-cc" multiple></select>

    <label>Subject</label>
    <input type="text" id="email-subject" placeholder="Subject..." />

    <label>Message</label>
    <div id="email-message" class="rich-editor" contenteditable="true" style="height: 200px; border: 1px solid #ccc; padding: 10px; border-radius: 8px;"></div>

    <button id="sendEmailBtn">Send</button>
  </div>
</div>
<!-- Popup inicial para elegir acciÃ³n -->
<div id="chooseCandidateActionPopup" class="popup hidden">
  <div class="popup-content">
    <span class="close-btn" id="closeChoosePopup">&times;</span>
    <h2>Add to Pipeline</h2>
    <p>Letâ€™s get someone on board!</p>
    <button id="openNewCandidatePopup">Create New Candidate</button>
  </div>
</div>
<div id="preCreateCheckPopup" class="popup hidden">
  <div class="popup-content">
    <span class="close-btn" id="closePreCreatePopup">&times;</span>
    <h2>Check Candidate</h2>
    <p style="margin-bottom: 10px;">Let's check if this candidate already exists</p>
    <input type="text" id="precreate-search" placeholder="Full name or search..." autocomplete="off"/>
    
    <!-- mensaje de coincidencias -->
    <p id="precreate-found-msg" style="display: none; color: #444; font-weight: 500; margin-top: 10px;">We found some matches</p>
    
    <ul id="precreate-results" class="search-results-list"></ul>

    <div id="precreate-no-match" style="display:none; margin-top:20px; text-align: center;">
      <p>We're all set! Create a new candidate</p>
      <button id="goToCreateCandidateBtn" class="arrow-btn"></button>
    </div>
  </div>
</div>


<div id="email-overlay" class="email-overlay hidden">
  <div class="email-overlay-content">
    <span class="spinner"></span>
    <p id="email-overlay-message">Sending email...</p>
  </div>
</div>

<!-- Sign Off Popup -->
<div id="signOffPopup" class="popup hidden">
  <div class="popup-content email-popup-content">
    <span class="close-btn" id="closeSignOffPopup">&times;</span>
    <h2>Send Rejection Email</h2>

    <label>To</label>
    <select id="signoff-to" multiple></select>

    <label>Subject</label>
    <input type="text" id="signoff-subject" value="Update on your application" />

    <label>Message</label>
    <textarea id="signoff-message" style="height: 200px;">Dear applicant,

Thank you so much for being part of our process at Vintti. After careful consideration, weâ€™ve decided to move forward with another candidate.

We truly appreciate your time and interest!
If you'd like to share your experience with the selection process, hereâ€™s a short anonymous survey (under 3 minutes):
ğŸ”— https://tally.so/r/w7K859

Wishing you all the best in your journey! âœ¨
Warmly,
the Vintti team</textarea>

    <div style="margin-top: 10px;">
      <button id="toggleLangBtn">Change Language</button>
    </div>

    <button id="sendSignOffBtn">Send</button>
  </div>
</div>
<div id="approvalEmailPopup" class="popup hidden">
  <div class="popup-content email-popup-content">
    <span class="close-btn" id="closeApprovalEmailPopup">&times;</span>
    <h2>Send Candidates for Approval</h2>

    <label>To</label>
    <select id="approval-to" multiple></select>

    <label>CC</label>
    <select id="approval-cc" multiple></select>

    <label>Subject</label>
    <input type="text" id="approval-subject" placeholder="Subject..." />

    <label>Message</label>
    <div id="approval-message" contenteditable="true" style="height: 300px; border: 1px solid #ccc; padding: 10px; border-radius: 8px; overflow-y: auto;"></div>

    <button id="sendApprovalEmailBtn">Send</button>
  </div>
</div>
<!-- Nueva popup para fecha de presentaciÃ³n -->
<div id="createBatchPopup" class="popup hidden">
  <div class="popup-content">
    <span class="close-btn" id="closeCreateBatchPopup">&times;</span>
    <h2>Create New Batch</h2>
    <label for="presentationDateInput">Presentation Date</label>
    <input type="date" id="presentationDateInput" />
    <button id="confirmCreateBatchBtn">Create Batch</button>
  </div>
</div>

<script src="./assets/js/opportunity-detail.js"></script>
</body>
</html>

